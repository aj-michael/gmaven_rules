---
platforms:
  ubuntu1404:
    # TODO(jingwen): switch these to sh_test and port them to macos and windows
    shell_commands:
    - ./tests/integration/simple_integration_test.sh
    - ./tests/integration/artifact_exclusions_integration_test.sh
    - ./tests/integration/unsafe_shared_cache_integration_test.sh
    build_targets:
    - "//examples:app"
    test_targets:
    - "//tests/unit/..."
  ubuntu1604:
    shell_commands:
    - ./tests/integration/simple_integration_test.sh
    - ./tests/integration/artifact_exclusions_integration_test.sh
    - ./tests/integration/unsafe_shared_cache_integration_test.sh
    build_targets:
    - "//examples:app"
    test_targets:
    - "//tests/unit/..."
  ubuntu1804:
    shell_commands:
    - ./tests/integration/simple_integration_test.sh
    - ./tests/integration/artifact_exclusions_integration_test.sh
    - ./tests/integration/unsafe_shared_cache_integration_test.sh
    build_targets:
    - "//examples:app"
    test_targets:
    - "//tests/unit/..."
  macos:
    build_targets:
    - "//examples:app"
    test_targets:
    - "//tests/unit/..."
  windows:
    # build_targets:
    # TODO(jin): fix long paths issue on Windows 
    # - "//examples:app"
    test_targets:
    - "//tests/unit/..."
tasks:
  simple-linux:
    name: "Simple example"
    platform: ubuntu1804
    working_directory: examples/simple
    build_targets:
    - "..."
  simple-macos:
    name: "Simple example"
    platform: macos
    working_directory: examples/simple
    build_targets:
    - "..."
  simple-windows:
    name: "Simple example"
    platform: windows
    working_directory: examples/simple
    build_targets:
      - "..."
  android-instrumentation-test-linux:
    name: "Android instrumentation test example"
    platform: ubuntu1804
    working_directory: examples/android_instrumentation_test
    test_targets:
    - "//src/test:greeter_test"
  android-instrumentation-test-macos:
    name: "Android instrumentation test example"
    platform: macos
    working_directory: examples/android_instrumentation_test
    build_targets:
    - "//src/test:greeter_app"
    - "//src/test:greeter_test_app"
  android-instrumentation-test-windows:
    name: "Android instrumentation test example"
    platform: windows
    working_directory: examples/android_instrumentation_test
    build_targets:
    - "//src/test:greeter_app"
    - "//src/test:greeter_test_app"
